<%- include('../partials/head', { title, description, request }) %>
<%- include('../partials/header') %>
<section class="py-5">
  <div class="container">
    <h1 class="mb-4">Contract oferta <%= offer.offer_code %></h1>
    <style>
      .contract-public {
        background-color: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 1rem;
        padding: 2rem;
      }
      .contract-public .contract-document__signatures {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        margin-top: 2rem;
      }
      @media (min-width: 768px) {
        .contract-public .contract-document__signatures {
          flex-direction: row;
          justify-content: space-between;
        }
      }
      .contract-public .signature-box {
        border: 1px dashed #6c757d;
        border-radius: 0.75rem;
        padding: 1rem;
        min-height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f8f9fa;
      }
      .contract-public .signature-image {
        max-width: 100%;
        max-height: 110px;
        object-fit: contain;
      }
    </style>
    <div class="mb-3">
      <% const statusMap = {
      sent: 'Ofertă transmisă',
      pending: 'În pregătire',
      accepted: 'Acceptată',
      refused: 'Refuzată',
      expired: 'Expirată',
      counter_pending: 'Contraofertă în așteptare',
      counter_submitted: 'Contraofertă trimisă'
      }; %>
      <span class="badge bg-primary">Status: <%= statusMap[offer.status] || offer.status %></span>
    </div>
    <% if (offer.contract_text) { %>
    <% const contractContainsHtml = /<[^>]+>/.test(offer.contract_text); %>
    <div class="card shadow-sm">
      <div class="card-body">
        <% if (contractContainsHtml) { %>
        <div class="contract-public">
          <%- offer.contract_text %>
        </div>
        <% } else { %>
        <pre class="contract-text"><%= offer.contract_text %></pre>
        <% } %>
      </div>
    </div>
    <% } else { %>
    <div class="alert alert-warning">Contractul va fi generat automat după ce administratorul setează oferta finală.</div>
    <% } %>
    <div class="alert alert-info mt-4">
      Pentru a semna contractul și a interacționa cu oferta, autentifică-te în platforma Licențe la Cheie.
    </div>
  </div>
</section>
<%- include('../partials/footer') %>
