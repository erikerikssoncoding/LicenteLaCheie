<%- include('../partials/head', { title, description, request }) %>
<%- include('../partials/header') %>
<section class="py-5 bg-light">
  <div class="container">
    <div class="row align-items-start">
      <div class="col-lg-6">
        <h1>Solicită ofertă pentru lucrarea academică sau materialul infodocumentar</h1>
        <p class="lead">
          Completează formularul și platforma va genera un contract draft pe care îl poți semna digital după validare.
        </p>
        <ul class="list-check">
          <li>Evaluare gratuită a cerințelor și temei</li>
          <li>Contract personalizat și garanție de livrare</li>
          <li>Proces securizat, compliant cu GDPR</li>
        </ul>
      </div>
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert alert-danger"><%= error %></div>
            <% } %>
            <form action="/oferta" method="post" class="row g-3">
              <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
              <div class="col-12">
                <label class="form-label" for="clientName">Nume complet</label>
                <input
                  class="form-control"
                  type="text"
                  id="clientName"
                  name="clientName"
                  value="<%= request.body?.clientName || currentUser?.fullName || '' %>"
                  <%= currentUser ? 'readonly' : '' %>
                  required
                />
              </div>
              <div class="col-md-6">
                <label class="form-label" for="email">Email</label>
                <input
                  class="form-control"
                  type="email"
                  id="email"
                  name="email"
                  value="<%= request.body?.email || currentUser?.email || '' %>"
                  <%= currentUser ? 'readonly' : '' %>
                  required
                />
              </div>
              <div class="col-md-6">
                <label class="form-label" for="phone">Telefon</label>
                <input
                  class="form-control"
                  type="tel"
                  id="phone"
                  name="phone"
                  value="<%= request.body?.phone || currentUser?.phone || '' %>"
                  required
                />
              </div>
              <div class="col-md-6">
                <label class="form-label" for="program">Program de studiu</label>
                <input class="form-control" type="text" id="program" name="program" value="<%= request.body?.program || '' %>" required />
              </div>
              <div class="col-md-6">
                <label class="form-label" for="topic">Tema lucrării</label>
                <input class="form-control" type="text" id="topic" name="topic" value="<%= request.body?.topic || '' %>" required />
              </div>
              <div class="col-md-6">
                <label class="form-label" for="workType">Tipul lucrării</label>
                <select class="form-select" id="workType" name="workType" required>
                  <option value="" disabled <%= request.body?.workType ? '' : 'selected' %>>Selectează tipul lucrării</option>
                  <option value="lucrare de licenta" <%= request.body?.workType === 'lucrare de licenta' ? 'selected' : '' %>>Lucrare de licență</option>
                  <option value="lucrare de grad" <%= request.body?.workType === 'lucrare de grad' ? 'selected' : '' %>>Lucrare de grad</option>
                  <option value="lucrare de disertatie" <%= request.body?.workType === 'lucrare de disertatie' ? 'selected' : '' %>>Lucrare de disertație</option>
                  <option value="lucrare de doctorat" <%= request.body?.workType === 'lucrare de doctorat' ? 'selected' : '' %>>Lucrare de doctorat</option>
                  <option value="proiect" <%= request.body?.workType === 'proiect' ? 'selected' : '' %>>Proiect</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label" for="deliveryDate">Data dorită de livrare</label>
                <input
                  class="form-control"
                  type="date"
                  id="deliveryDate"
                  name="deliveryDate"
                  min="<%= minDeliveryDate %>"
                  value="<%= request.body?.deliveryDate || minDeliveryDate %>"
                  required
                />
              </div>
              <div class="col-12">
                <label class="form-label" for="notes">Detalii suplimentare</label>
                <textarea class="form-control" id="notes" name="notes" rows="3"><%= request.body?.notes || '' %></textarea>
              </div>
              <% if (!currentUser) { %>
              <div class="col-12">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="on"
                    id="acceptAccount"
                    name="acceptAccount"
                    <%= request.body?.acceptAccount ? 'checked' : '' %>
                    required
                  />
                  <label class="form-check-label" for="acceptAccount">
                    Sunt de acord să fie creat un cont Licențe la Cheie pentru gestionarea ofertei și a contractului.
                  </label>
                </div>
              </div>
              <% } %>
              <div class="col-12 text-end">
                <button class="btn btn-primary" type="submit">Trimite solicitarea</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<%- include('../partials/footer') %>
